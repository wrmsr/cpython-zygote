- compiler switchable branch liklihood bias
- switchable deallocation modes: call dtor or dont
- todo freelists
- https://code.google.com/p/chromium/wiki/LinuxZygote
- https://stackoverflow.com/questions/2731531/faster-forking-of-large-processes-on-linux
- https://github.com/Yelp/zygote/tree/master/zygote
- make sure greenlet still works
- l3 sharing
- page analyzer
- pre-toucher / ideally modify page flags to let it happen naturally in fork()
- /proc smaps + pagemap
- graceful fallback cfg'd in py, already available in ctypes.pythonapi
- mallocstat can tell which arenas are pinned in py
- port Py_PINNED to py
- track parent [well, root really] pid in zygote, pagemaps can tell which were hit
- ... only things allocated are arenas, maintain freelist
 - sort and shrink
  - naw just double LL, choose least
 - fork friendly malloc? alloc all holes?
- Memory mappings that have been marked with the madvise(2) MADV_DONTFORK flag are not inherited across a fork().
- configurable bump allocation (for both pymalloc and jemalloc) - uh wow pin use remaining pinned space :||||
- jemalloc just reinit, fuck freeing
- https://www.python.org/dev/peps/pep-0445/#don-t-call-malloc-directly-anymore
- https://media.blackhat.com/bh-us-12/Briefings/Argyoudis/BH_US_12_Argyroudis_Exploiting_the_%20jemalloc_Memory_%20Allocator_WP.pdf
- shared mem for transport
- wsgi client recycling policy
https://github.com/torvalds/linux/blob/master/fs/proc/task_mmu.c#L1329 oh you fucking pricks
https://github.com/torvalds/linux/commit/ab676b7d6fbf4b294bf198fb27ade5b0e865c7ce <^>

- interactive zygote, python repl

https://github.com/wrmsr/cpython-zygote/compare/master...wrmsr_zygote#files_bucket

http://neugierig.org/software/chromium/notes/2011/08/zygote.html

* TODO allocation context struct - threadlocal
- mp [billiard] worker pool, zmq pool

sudo apt-get install libbz2-dev
 ./configure --enable-unicode=ucs4
